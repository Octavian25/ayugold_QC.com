(this.webpackJsonpAyuGold=this.webpackJsonpAyuGold||[]).push([[166],{1130:function(e,t,a){"use strict";a.r(t);var o=a(166),r=a.n(o),s=a(220),n=a(64),l=a(24),i=a(25),c=a(27),u=a(26),p=a(0),m=a.n(p),g=a(17),d=a(12),h=a(327),k=a(328),_=a(67),v=a(65),b=a(13),f=a.n(b),S=a(133),E=a(23),y=a(218),O=a(52),N=a(59),F=a(47),j=a.n(F),I=a(32),L=a(129),C=a(167),B=a(168),x=a(36),R=a(5),q=a(66),J=a(34),T=a(43),w=a(6),V=Object(p.lazy)((function(){return Promise.resolve().then(a.bind(null,219))})),K=Object(p.lazy)((function(){return a.e(108).then(a.bind(null,1118))})),D=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var o;return Object(l.a)(this,a),(o=t.call(this,e)).inputChange=function(e){return function(t){o.setState(Object(n.a)({},e,t.target.value))}},o.state={listLokasi:[],listSales:[],listCustomer:[],listPacking:[],kodeCustomer:"",columns:[{dataField:"kode_jenis",text:"Kode Model"},{dataField:"bruto",text:"Berat\n(Gr)",align:"right",headerAlign:"right"},{dataField:"qty",text:"Qty",align:"right",headerAlign:"right"},{dataField:"ongkos_rp",text:"Ongkos Reparasi(Rp)",align:"right",headerAlign:"right",formatter:function(e,t){return parseInt(e).toLocaleString("id-ID")}},{dataField:"Aksi",text:"Aksi",csvExport:!1,formatter:function(e,t,a){return m.a.createElement("div",{className:"text-center"},m.a.createElement("button",{"data-tip":!0,"data-for":"hapus",className:"btn btn-danger mr-2",onClick:function(){return o.deleteRow(a,t.netto_disc)}},m.a.createElement(N.a,{id:"hapus",type:"dark",effect:"solid"},m.a.createElement("span",null,"Hapus")),m.a.createElement("i",{className:"fa fa-trash mr-1"})),m.a.createElement("br",null))}}],noBon:"",namaCustomer:"",lokasi:"",sales:"",namaToko:"",tanggal:"",data:"",field_level1:"col-lg-4 invisible",field_level2:"col-lg-4 invisible"},o}return Object(i.a)(a,[{key:"deleteRow",value:function(e,t){var a=this;f.a.fire({title:"Anda Yakin ?",text:"Anda Akan Menghapus Data Ini ?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, delete it!"}).then((function(o){if(o.isConfirmed){var r=JSON.parse(localStorage.getItem("transaksiReparasi"))||[];r.splice(e,1),localStorage.setItem("transaksiReparasi",JSON.stringify(r));var s=localStorage.getItem("GrandTotalNetto"),n=parseFloat(s)-parseFloat(t);localStorage.setItem("GrandTotalNetto",parseFloat(n).toFixed(3)),f.a.fire({text:"Berhasil",timer:2e3,showConfirmButton:!1,position:"top-right",icon:"success"}).then((function(){return a.props.dispatch(Object(S.f)())}))}}))}},{key:"componentDidMount",value:function(){localStorage.removeItem("transaksiReparasi_level2"),localStorage.removeItem("transaksiReparasi_level3"),localStorage.removeItem("nota_reparasi_level1"),localStorage.removeItem("nota_reparasi_level2"),localStorage.removeItem("nota_reparasi_level3"),localStorage.removeItem("transaksiReparasi"),this.props.dispatch(Object(S.f)()),this.props.dispatch(Object(C.d)()),this.props.dispatch(Object(B.d)()),this.props.dispatch(Object(x.h)()),this.props.dispatch(Object(v.b)())}},{key:"handleSubmit",value:function(){var e=Object(s.a)(r.a.mark((function e(t){var a,o,s,n,l=this;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=0,o=0,s="LEVEL2"===this.state.level_customer?this.state.kodeCustomer:localStorage.getItem("customer_2"),n="LEVEL3"===this.state.level_customer?this.state.kodeCustomer:"-",e.next=6,Object(R.b)("/kelompok-harga/get/by-jenis-and-customer/".concat(s,"&").concat(t.kodeBarang)).then((function(e){return a=e.data.ongkos_reparasi||0})).catch((function(){return a=0}));case 6:return e.next=8,Object(R.b)("/kelompok-harga/get/by-jenis-and-customer/".concat(n,"&").concat(t.kodeBarang)).then((function(e){return o=e.data.ongkos_reparasi||0})).catch((function(){return o=0}));case 8:Object(R.b)("jenis/get/by-kode-jenis/".concat(t.kodeBarang)).then((function(e){var r=t.kodeKategori,s=JSON.parse(localStorage.getItem("nota_reparasi_level1"))||[],n=JSON.parse(localStorage.getItem("nota_reparasi_level2"))||[],i=JSON.parse(localStorage.getItem("nota_reparasi_level3"))||[],c=s.findIndex((function(e){return e.kode_kategori===r})),u=n.findIndex((function(e){return e.kode_kategori===r})),p=i.findIndex((function(e){return e.kode_kategori===r}));if(-1!==c){var m={ongkos_rp:parseFloat(void 0===t.rp?0:t.rp)*parseFloat(t.qty)+parseFloat(s[c].ongkos_rp),bruto:(parseFloat(t.bruto||0)+parseFloat(s[c].bruto)).toFixed(3),kode_kategori:t.kodeKategori,qty:t.qty},g={ongkos_rp:parseFloat(a)*parseFloat(t.qty)+parseFloat(n[c].ongkos_rp),bruto:(parseFloat(t.bruto||0)+parseFloat(n[c].bruto)).toFixed(3),kode_kategori:t.kodeKategori,qty:t.qty},h={ongkos_rp:parseFloat(o)*parseFloat(t.qty)+parseFloat(i[c].ongkos_rp),bruto:(parseFloat(t.bruto||0)+parseFloat(i[c].bruto)).toFixed(3),kode_kategori:t.kodeKategori,qty:t.qty};s.push(m),n.push(g),i.push(h),s.splice(c,1),n.splice(u,1),i.splice(p,1),localStorage.setItem("nota_reparasi_level1",JSON.stringify(s)),localStorage.setItem("nota_reparasi_level2",JSON.stringify(n)),localStorage.setItem("nota_reparasi_level3",JSON.stringify(i))}else{var k={ongkos_rp:parseFloat(void 0===t.rp?0:t.rp)*parseFloat(t.qty),bruto:parseFloat(t.bruto||0).toFixed(3),kode_kategori:t.kodeKategori,qty:t.qty},_={ongkos_rp:parseFloat(void 0===a?0:a)*parseFloat(t.qty),bruto:parseFloat(t.bruto||0),kode_kategori:t.kodeKategori,qty:t.qty},v={ongkos_rp:parseFloat(void 0===o?0:o)*parseFloat(t.qty),bruto:parseFloat(t.bruto||0),kode_kategori:t.kodeKategori,qty:t.qty};s.push(k),n.push(_),i.push(v),localStorage.setItem("nota_reparasi_level1",JSON.stringify(s)),localStorage.setItem("nota_reparasi_level2",JSON.stringify(n)),localStorage.setItem("nota_reparasi_level3",JSON.stringify(i))}var b={qty:t.qty,ongkos_rp:parseFloat(void 0===t.rp?0:t.rp),bruto:parseFloat(t.bruto||0).toFixed(3),kode_jenis:t.kodeBarang},E={qty:t.qty,ongkos_rp:parseFloat(void 0===a?0:a),bruto:parseFloat(t.bruto||0).toFixed(3),kode_jenis:t.kodeBarang},y={qty:t.qty,ongkos_rp:parseFloat(void 0===o?0:o),bruto:parseFloat(t.bruto||0).toFixed(3),kode_jenis:t.kodeBarang},O=JSON.parse(localStorage.getItem("transaksiReparasi"))||[],N=JSON.parse(localStorage.getItem("transaksiReparasi_level2"))||[],F=JSON.parse(localStorage.getItem("transaksiReparasi_level3"))||[];O.push(b),N.push(E),F.push(y),localStorage.setItem("transaksiReparasi",JSON.stringify(O)),localStorage.setItem("transaksiReparasi_level2",JSON.stringify(N)),localStorage.setItem("transaksiReparasi_level3",JSON.stringify(F)),f.a.fire({position:"top-end",icon:"success",text:"Data Berhasil Ditambahkan!",showConfirmButton:!1,timer:1500}),l.props.dispatch(Object(S.f)()),l.props.dispatch(Object(d.b)("FormTransaksiReparasi"))})).catch((function(e){return Object(O.c)("Kode Kelompok Belum Disesuaikan, Mohon Sesuaikan Dahulu")}));case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"transaksiPenjualanSubmit",value:function(){var e=this;if(null===localStorage.getItem("transaksiReparasi"))return Object(O.e)("Barang masih kosong, Silahkan tambah barang"),!1;if(""===this.state.noBon)return Object(O.e)("Mohon isi Nomor bon"),!1;if(""===this.state.lokasi)return Object(O.e)("Mohon pilih lokasi"),!1;if(""===this.state.sales)return Object(O.e)("Mohon pilih Sales"),!1;var t={};switch(this.state.level_customer){case"LEVEL1":t={no_bon:this.state.noBon.toUpperCase(),no_reparasi:this.props.noFaktur.toUpperCase(),tanggal:this.state.tanggal||Object(T.b)(),kode_lokasi:this.state.lokasi.toUpperCase(),kode_sales:this.state.sales.toUpperCase(),kode_customer:this.state.kodeCustomer.toUpperCase(),level_customer_trx:this.state.level_customer,kode_customer_level2:localStorage.getItem("customer_1")||"-",kode_customer_level3:localStorage.getItem("customer_2")||"-",detail_barang:JSON.parse(localStorage.getItem("transaksiReparasi"))};break;case"LEVEL2":t={no_bon:this.state.noBon.toUpperCase(),no_reparasi:this.props.noFaktur.toUpperCase(),tanggal:this.state.tanggal||Object(T.b)(),kode_lokasi:this.state.lokasi.toUpperCase(),kode_sales:this.state.sales.toUpperCase(),kode_customer:localStorage.getItem("customer_1")||"-",level_customer_trx:this.state.level_customer,kode_customer_level2:this.state.kodeCustomer,kode_customer_level3:localStorage.getItem("customer_2")||"-",detail_barang:JSON.parse(localStorage.getItem("transaksiReparasi"))};break;case"LEVEL3":t={no_bon:this.state.noBon.toUpperCase(),no_reparasi:this.props.noFaktur.toUpperCase(),tanggal:this.state.tanggal||Object(T.b)(),kode_lokasi:this.state.lokasi.toUpperCase(),kode_sales:this.state.sales.toUpperCase(),kode_customer:localStorage.getItem("customer_1")||"-",level_customer_trx:this.state.level_customer,kode_customer_level2:localStorage.getItem("customer_2")||"-",kode_customer_level3:this.state.kodeCustomer,detail_barang:JSON.parse(localStorage.getItem("transaksiReparasi"))};break;default:Object(O.e)("Ada Kesalah Saat Proses Level Customer")}this.props.dispatch(Object(E.t)()),Object(R.c)("reparasi/post/simpan-transaksi",t).then((function(){return f.a.fire({position:"top-end",icon:"success",text:"Data Berhasil Ditambahkan!",showConfirmButton:!1,timer:1500}).then((function(){switch(e.state.level_customer){case"LEVEL1":e.printNota("LEVEL1");break;case"LEVEL2":e.printNota("LEVEL1"),e.printNota("LEVEL2");break;case"LEVEL3":e.printNota("LEVEL1"),e.printNota("LEVEL2"),e.printNota("LEVEL3")}})).then((function(){return e.props.dispatch(Object(E.k)())})).then((function(){return localStorage.removeItem("transaksiReparasi")})).then((function(){return localStorage.removeItem("transaksiReparasi_level2")})).then((function(){return localStorage.removeItem("transaksiReparasi_level3")})).then((function(){return localStorage.removeItem("noFaktur")})).then((function(){return e.props.dispatch(Object(v.b)())})).then((function(){return e.props.dispatch(Object(S.f)())})).then((function(){return e.setState({noBon:"",namaCustomer:"",lokasi:"",sales:"",namaToko:"",tanggal:"",toko:""})})).then((function(){return document.getElementById("myForm").reset()})).then((function(){return window.location.reload()}))})).catch((function(t){return f.a.fire({position:"top-end",icon:"error",text:"".concat(t),showConfirmButton:!1,timer:1500}).then((function(){return e.props.dispatch(Object(E.k)())}))}))}},{key:"printNota",value:function(e){var t=[],a=[],o=[],r=[];switch(e){case"LEVEL1":(a=JSON.parse(localStorage.getItem("nota_reparasi_level1"))).forEach((function(e,a){var o=[++a,e.kode_kategori,{content:e.qty,styles:{halign:"right"}},{content:Object(w.m)(parseFloat(e.bruto)),styles:{halign:"right"}},{content:Object(w.p)(e.ongkos_rp),styles:{halign:"right"}}];t.push(o)})),o=["","",{content:a.map((function(e){return parseFloat(e.qty)})).reduce((function(e,t){return e+t}),0),styles:{halign:"right"}},{content:Object(w.m)(a.map((function(e){return parseFloat(e.bruto)})).reduce((function(e,t){return e+t}),0)),styles:{halign:"right"}},{content:Object(w.p)(a.map((function(e){return parseInt(e.ongkos_rp)})).reduce((function(e,t){return e+t}),0)),styles:{halign:"right"}}],console.log(JSON.stringify(t)),r=[["No","Kode Kategori",{content:"Qty",styles:{halign:"right"}},{content:"Bruto \n(Gr)",styles:{halign:"right"}},{content:"Ongkos Reparasi",styles:{halign:"right"}}]],Object(y.a)("no Trx",this.props.noFaktur,"Tanggal",this.state.tanggal||Object(T.b)(),"No Bon",this.state.noBon,"Sales",this.state.sales,Object(w.s)(),Object(T.b)(),"",r,"Transaksi Reparasi",t,o);break;case"LEVEL2":(a=JSON.parse(localStorage.getItem("nota_reparasi_level2"))).forEach((function(e,a){var o=[++a,e.kode_kategori,e.qty,parseFloat(e.bruto).toFixed(3),e.ongkos_rp.toLocaleString("id-ID")];t.push(o)})),o=["","",a.map((function(e){return parseFloat(e.qty)})).reduce((function(e,t){return e+t}),0),a.map((function(e){return parseFloat(e.bruto)})).reduce((function(e,t){return e+t}),0).toFixed(3),a.map((function(e){return parseInt(e.ongkos_rp)})).reduce((function(e,t){return e+t}),0).toLocaleString("id-ID")],t.push(o),console.log(JSON.stringify(t)),r=["No","Kode Kategori","Qty","Bruto \n(Gr)","Ongkos Reparasi"],Object(y.a)("no Trx",this.props.noFaktur,"Tanggal",this.state.tanggal||Object(T.b)(),"No Bon",this.state.noBon,"Sales",this.state.sales,"ADMIN",this.state.tanggal||Object(T.b)(),"",r,"Transaksi Reparasi",t);break;case"LEVEL3":(a=JSON.parse(localStorage.getItem("nota_reparasi_level3"))).forEach((function(e,a){var o=[++a,e.kode_kategori,e.qty,parseFloat(e.bruto).toFixed(3),e.ongkos_rp.toLocaleString("id-ID")];t.push(o)})),o=["","",a.map((function(e){return parseFloat(e.qty)})).reduce((function(e,t){return e+t}),0),a.map((function(e){return parseFloat(e.bruto)})).reduce((function(e,t){return e+t}),0).toFixed(3),a.map((function(e){return parseInt(e.ongkos_rp)})).reduce((function(e,t){return e+t}),0).toLocaleString("id-ID")],t.push(o),console.log(JSON.stringify(t)),r=["No","Kode Kategori","Qty","Bruto \n(Gr)","Ongkos Reparasi"],Object(y.a)("no Trx",this.props.noFaktur,"Tanggal",this.state.tanggal||Object(T.b)(),"No Bon",this.state.noBon,"Sales",this.state.sales,"ADMIN",this.state.tanggal||Object(T.b)(),"",r,"Transaksi Reparasi",t);break;default:Object(O.e)("Error Print")}}},{key:"onSubmit",value:function(e,t){this.setState(Object(n.a)({},t,e))}},{key:"onSubmitToko",value:function(e){var t=this,a=e,o=this.props.listCustomer.filter((function(e){return e.kode_customer===a}));this.setState({kodeCustomer:e,level_customer:o[0].level_customer}),this.props.change("level_customer",o[0].level_customer),"LEVEL2"===o[0].level_customer?this.setState({field_level1:"col-lg-4",field_level2:"col-lg-4 invisible"}):"LEVEL3"===o[0].level_customer?this.setState({field_level1:"col-lg-4",field_level2:"col-lg-4"}):this.setState({field_level1:"col-lg-4 invisible",field_level2:"col-lg-4 invisible"}),Object(R.b)("customer/get/by-kode-customer/".concat(e)).then((function(e){var a=e.data;t.setState({kode_customer_level1:a.kode_customer_level1,kode_customer_level2:a.kode_customer_level2}),t.props.change("level_customer_1",a.kode_customer_level1),t.props.change("level_customer_2",a.kode_customer_level2)}))}},{key:"render",value:function(){var e=this,t=[{value:"SALES",name:"SALES"}];return this.props.listLokasi.map((function(e){var a={value:e.kode_lokasi,name:e.nama_lokasi};return t.push(a),!0})),m.a.createElement("div",{className:"container-fluid"},""!==String(this.props.listPacking)?m.a.createElement("div",{className:"col-lg-12"},m.a.createElement("div",{className:"card"},m.a.createElement(L.default,{title:"Transaksi Reparasi"}),m.a.createElement("div",{className:"card-body"},m.a.createElement("div",{className:"row"},m.a.createElement("div",{className:"col-lg-12"},m.a.createElement("form",{id:"myForm",onKeyDown:function(e){return"Enter"!==e.key}},m.a.createElement("div",{className:"row"},m.a.createElement("div",{className:"col-lg-4 col-md-4"},m.a.createElement("div",{className:"form-group"},m.a.createElement("label",{htmlFor:""},"Tanggal"),m.a.createElement("input",{name:"tanggal",type:"date",label:"Tanggal",className:"form-control",onChange:this.inputChange("tanggal"),defaultValue:Object(T.b)()}))),m.a.createElement("div",{className:"col-lg-4 col-md-4"},m.a.createElement("div",{className:"form-group"},m.a.createElement("label",{htmlFor:""},"No Bon"),m.a.createElement("input",{name:"noBon",type:"text",label:"No Bon",className:"form-control",onChange:this.inputChange("noBon"),value:this.state.noBon}))),m.a.createElement("div",{className:"col-lg-4 col-md-4"}),m.a.createElement("div",{className:"col-lg-4 col-md-4"},m.a.createElement("div",{className:"form-group"},m.a.createElement("label",{htmlFor:""},"Lokasi"),m.a.createElement(_.a,{options:t,search:!0,placeholder:"Silahkan Pilih",onChange:function(t){return e.onSubmit(t,"lokasi")},value:this.state.lokasi}))),m.a.createElement("div",{className:"col-lg-4 col-md-4"},m.a.createElement("div",{className:"form-group"},m.a.createElement("label",{htmlFor:""},"Sales"),m.a.createElement(_.a,{options:this.props.listSales.map((function(e){return{value:e.kode_sales,name:e.nama_sales}})),search:!0,placeholder:"Silahkan Pilih",onChange:function(t){return e.onSubmit(t,"sales")},value:this.state.sales}))),m.a.createElement("div",{className:"col-lg-4 col-md-4"},m.a.createElement("div",{className:"form-group"},m.a.createElement("label",{htmlFor:""},"Nama Toko"),m.a.createElement(_.a,{options:this.props.listCustomer.map((function(e){return{value:e.kode_customer,name:e.nama_toko+" - "+e.nama_customer}})),search:!0,placeholder:"Silahkan Pilih",onChange:function(t){return e.onSubmitToko(t)},onBlur:function(t){return e.onSubmit(t,"namaToko")},value:this.state.toko}))),m.a.createElement("div",{className:"col-lg-4"},m.a.createElement(h.a,{name:"level_customer",component:J.a,type:"text",label:"Level Customer",placeholder:"Masukan Level Customer",readOnly:!0})),m.a.createElement("div",{className:this.state.field_level1},m.a.createElement(h.a,{name:"level_customer_1",component:J.b,options:this.props.listCustomer.filter((function(e){return"LEVEL1"===e.level_customer})).map((function(e){return{value:e.kode_customer,name:e.nama_toko+" - "+e.nama_customer}})),type:"text",label:"Level Customer 1",placeholder:"Level Customer 1",onChange:function(e){return localStorage.setItem("customer_1",e)}})),m.a.createElement("div",{className:this.state.field_level2},m.a.createElement(h.a,{name:"level_customer_2",component:J.b,options:this.props.listCustomer.filter((function(e){return"LEVEL2"===e.level_customer})).map((function(e){return{value:e.kode_customer,name:e.nama_toko+" - "+e.nama_customer}})),type:"text",label:"Level Customer 2",placeholder:"Level Customer 2",onChange:function(e){return localStorage.setItem("customer_2",e)}}))))),m.a.createElement("div",{className:"col-lg-8"}),m.a.createElement("div",{className:"col-lg-4"},m.a.createElement("div",{className:"text-right"},m.a.createElement("button",{className:"btn btn-primary",onClick:function(){return e.props.dispatch(Object(I.j)())},disabled:""===this.state.kodeCustomer},"Tambah Barang",m.a.createElement("i",{class:"fa fa-plus ml-3","aria-hidden":"true"})))),m.a.createElement("div",{className:"col-lg-12 mt-5"},m.a.createElement(q.a,{keyField:"id",data:this.props.listReparasi,columns:this.state.columns}),m.a.createElement("div",{className:"text-right"},m.a.createElement("button",{className:"btn btn-primary",disabled:this.props.onSend,onClick:function(){return e.transaksiPenjualanSubmit()}},this.props.onSend?m.a.createElement("span",{className:"spinner-border spinner-border-sm mr-3","aria-hidden":"true"}):null,"Simpan",m.a.createElement("i",{class:"fa fa-paper-plane ml-3","aria-hidden":"true"})))))))):m.a.createElement(j.a,{width:"100%",height:"100%"}),m.a.createElement(V,{content:m.a.createElement(p.Suspense,{fallback:m.a.createElement(j.a,{width:"100%",height:50,count:4})},m.a.createElement(K,{kode_customer:this.state.kodeCustomer,level_customer:this.state.level_customer,onSubmit:function(t){return e.handleSubmit(t)}})),title:"Tambah Data"}))}}]),a}(p.Component);D=Object(k.a)({form:"TransaksiReparasi",enableReinitialize:!0})(D),t.default=Object(g.b)((function(e){return{noFaktur:e.provinsi.noFaktur,listReparasi:e.provinsi.listReparasi,listCustomer:e.provinsi.customer,listLokasi:e.provinsi.lokasi,listSales:e.provinsi.salesman,username:e.provinsi.username,onSend:e.provinsi.onSend,kodeBarang:e.provinsi.kodeBarang}}),null)(D)}}]);
//# sourceMappingURL=166.402d8cab.chunk.js.map