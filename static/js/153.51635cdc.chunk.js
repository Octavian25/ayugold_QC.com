(this.webpackJsonpAyuGold=this.webpackJsonpAyuGold||[]).push([[153],{1200:function(a,e,t){"use strict";t.r(e);var o=t(185),r=t.n(o),n=t(237),l=t(15),s=t(16),i=t(18),c=t(17),d=t(0),p=t.n(d),u=t(12),m=t(11),k=t(343),g=t(344),_=t(347),b=t(236),h=t(19),F=t(37),v=t.n(F),j=t(88),f=t(6),S=t(5),E=t(13),y=t.n(E),N=t(146),O=t(145),x=t(23),K=t(20),G=t(24),B=Object(b.createNumberMask)({prefix:"Rp. ",suffix:",-",locale:"id-ID"}),I=function(a){Object(i.a)(t,a);var e=Object(c.a)(t);function t(a){var o;return Object(l.a)(this,t),(o=e.call(this,a)).handleBarcode=function(){return function(a){clearTimeout(o.delay),o.delay=setTimeout((function(){var e=a.target.value;if(14===e.length)return Object(S.b)("barang-set/get-by-kode-barcode-set-active/"+e).then((function(a){var e=a.data.detail_barang.map((function(a){return parseFloat(a.netto)})).reduce((function(a,e){return a+e}),0);a.data.detail_barang.forEach((function(t){o.handleBarcodeSet(t,a.data.kode_barcode_set,a.data.detail_barang.length,e,t.harga_jual,t.qty)}))})),!0;var t=e.split("X");o.props.change("kodeBarang",t[0]),o.setState({kodeJenis:t[0],kadarCetak:t[1],kadarJual:t[2]})}),1500)}},o.state={kodeBarang:[],non_aksesoris:"col-lg-12 row",aksesoris:"col-lg-12 row d-none",stockBruto:0,stockNetto:0},o}return Object(s.a)(t,[{key:"componentDidMount",value:function(){this.props.dispatch(Object(j.f)())}},{key:"onclick1",value:function(){if(this.state.stockBruto<this.props.bruto)return Object(x.e)("Barang Tersedia Hanya ".concat(this.state.stockBruto," , Mohon kurangi atau tambahkan stock dahulu")),!1;this.props.change("netto",this.props.netto),this.props.change("noFaktur",this.props.noFaktur),this.props.change("gross",this.props.gross),this.props.change("discGlobalGr",this.props.discGlobalGr),this.props.change("nettoDiscGlobalExt",(this.props.netto-this.props.discGlobalGr).toFixed(3))}},{key:"pilihBarang",value:function(a){var e=this,t=a,o=this.props.KodeBarangList.filter((function(a){return a.kode_jenis===t})),r=localStorage.getItem("customer_1")||"-";Object(S.b)("kelompok-harga/get/".concat(r,"&-&").concat(a,"&PUSAT")).then((function(a){var t,r,n,l,s,i,c,d,p,u,m,k,g;return(null===(t=a.data)||void 0===t?void 0:t.total_netto)<1?(Object(x.e)("Stock Barang Kurang Dari 1"),e.props.change("kodeBarang"),!1):void 0===(null===(r=a.data)||void 0===r?void 0:r.kode_tukar_normal)||"undefined"===(null===(n=a.data)||void 0===n?void 0:n.kode_tukar_normal)?(Object(x.e)("Kode Tukar Belum Ditentukan ,Mohon tentukan Kode Tukar di menu kelompok harga"),e.props.change("kodeBarang"),!1):("AKSESORIS"===(null===(l=a.data)||void 0===l?void 0:l.kode_kelompok)?e.setState({non_aksesoris:"col-lg-12 row d-none",aksesoris:"col-lg-12 row"}):e.setState({non_aksesoris:"col-lg-12 row",aksesoris:"col-lg-12 row d-none"}),e.setState({kodeJenis:o[0].kode_jenis,namaJenis:null===(s=a.data)||void 0===s?void 0:s.nama_jenis,kadarCetak:null===(i=a.data)||void 0===i?void 0:i.kode_tukar_normal,kadarJual:null===(c=a.data)||void 0===c?void 0:c.kode_tukar_normal,kodeKategori:null===(d=a.data)||void 0===d?void 0:d.kode_kategori,namaKategori:null===(p=a.data)||void 0===p?void 0:p.nama_kategori,diskon:(null===(u=a.data)||void 0===u?void 0:u.diskon)||0,harga_jual:(null===(m=a.data)||void 0===m?void 0:m.harga_aksesoris)||0,stockBruto:null===(k=a.data)||void 0===k?void 0:k.total_bruto,stockNetto:null===(g=a.data)||void 0===g?void 0:g.total_netto}),e.setKadar(),void Object(f.w)("Plastik"))}))}},{key:"setKadar",value:function(){this.props.change("keterangan",this.state.namaJenis),this.props.change("kadar",this.state.kadarCetak),this.props.change("kadarTransaksi",this.state.kadarJual),this.props.change("kodeKategori",this.state.kodeKategori),this.props.change("namaKategori",this.state.namaKategori),this.props.change("harga_jual",this.state.harga_jual),this.props.change("discGlobalPr",this.state.diskon)}},{key:"setBruto",value:function(){this.props.change("bruto",localStorage.getItem("Timbangan"))}},{key:"handleBarcodeSet",value:function(){var a=Object(n.a)(r.a.mark((function a(e,t,o,n,l,s){var i,c,d,p,u,k,g=this;return r.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return console.log(e),i=e.kode_jenis,c=this.props.KodeBarangList.filter((function(a){return a.kode_jenis===i})),d=0,p=0,u="LEVEL2"===this.props.level_customer?this.props.kodeCustomer:localStorage.getItem("customer_2"),k="LEVEL3"===this.props.level_customer?this.props.kodeCustomer:"-",a.next=9,Object(S.b)("/kelompok-harga/get/by-jenis-and-customer/".concat(u,"&").concat(e.kode_jenis)).then((function(a){return d=a.data.kode_tukar_normal||0})).catch((function(){return d=0}));case 9:return a.next=11,Object(S.b)("/kelompok-harga/get/by-jenis-and-customer/".concat(k,"&").concat(e.kode_jenis)).then((function(a){return p=a.data.kode_tukar_normal||0})).catch((function(){return p=0}));case 11:Object(S.b)("jenis/get/by-kode-jenis/".concat(e.kode_jenis)).then((function(a){var r,i=JSON.parse(localStorage.getItem("nota_penjualan_level1"))||[],u=JSON.parse(localStorage.getItem("nota_penjualan_level2"))||[],k=JSON.parse(localStorage.getItem("nota_penjualan_level3"))||[],_=JSON.parse(localStorage.getItem("nota_gambar"))||[],b=i.findIndex((function(a){return a.kode_kategori===a.kodeKategori})),h=u.findIndex((function(a){return a.kode_kategori===a.kodeKategori})),F=k.findIndex((function(a){return a.kode_kategori===a.kodeKategori}));if(_.push({lokasi_gambar:null===(r=a.data)||void 0===r?void 0:r.image}),localStorage.setItem("nota_gambar",JSON.stringify(_)),-1!==b){var v={netto_disc:(parseFloat(e.netto_disc||0)+parseFloat(i[b].netto_disc)).toFixed(3),netto:(parseFloat(e.netto||0)+parseFloat(i[b].netto)).toFixed(3),ongkos_rp:(parseFloat(void 0===e.rp?0:e.rp)+i[b].ongkos_rp).toLocaleString("id-ID"),disc:(parseFloat(e.disc_persen||0)+parseFloat(i[b].disc)).toFixed(3),bruto:(parseFloat(e.bruto||0)+parseFloat(i[b].bruto)).toFixed(3),kode_kategori:e.kodeKategori,kode_tukar:e.kadarTransaksi,keterangan:e.keterangan,jumlah_barang_set:o,total_berat_barang_set:n,kode_barcode_set:t,harga_jual:parseFloat(l)*parseFloat(s)+i[b].harga_jual},j={netto_disc:(parseFloat(e.bruto||0)*parseFloat(d)/100-parseFloat(e.disc_persen)*parseFloat(e.bruto||0)/100+parseFloat(u[b].netto_disc)).toFixed(3),netto:((parseFloat(e.bruto||0)*parseFloat(d)/100||0)+parseFloat(u[b].netto)).toFixed(3),ongkos_rp:parseFloat(void 0===e.rp?0:e.rp)+parseFloat(u[b].ongkos_rp),disc:(parseFloat(e.disc_persen)/100*parseFloat(e.bruto||0)+parseFloat(u[b].disc)).toFixed(3),bruto:parseFloat(e.bruto||0)+parseFloat(u[b].bruto),kode_kategori:e.kodeKategori,kode_tukar:d,keterangan:e.keterangan,jumlah_barang_set:o,total_berat_barang_set:n,kode_barcode_set:t,harga_jual:parseFloat(l)*parseFloat(s)+u[b].harga_jual},S={netto_disc:(parseFloat(e.bruto||0)*parseFloat(p)/100-parseFloat(e.disc_persen)*parseFloat(e.bruto||0)/100+parseFloat(k[b].netto_disc)).toFixed(3),netto:((parseFloat(e.bruto||0)*parseFloat(p)/100||0)+parseFloat(k[b].netto)).toFixed(3),ongkos_rp:parseFloat(void 0===e.rp?0:e.rp)+parseFloat(k[b].ongkos_rp),disc:(parseFloat(e.disc_persen)/100*parseFloat(e.bruto||0)+parseFloat(k[b].disc)).toFixed(3),bruto:parseFloat(e.bruto||0)+parseFloat(k[b].bruto),kode_kategori:e.kodeKategori,kode_tukar:p,keterangan:e.keterangan,jumlah_barang_set:o,total_berat_barang_set:n,kode_barcode_set:t,harga_jual:parseFloat(l)*parseFloat(s)+ +k[b].harga_jual};i.push(v),u.push(j),k.push(S),i.splice(b,1),u.splice(h,1),k.splice(F,1),localStorage.setItem("nota_penjualan_level1",JSON.stringify(i)),localStorage.setItem("nota_penjualan_level2",JSON.stringify(u)),localStorage.setItem("nota_penjualan_level3",JSON.stringify(k))}else{var E={netto_disc:parseFloat(e.netto_disc||0).toFixed(3),netto:parseFloat(e.netto||0).toFixed(3),ongkos_rp:parseFloat(void 0===e.rp?0:e.rp),disc:e.discGlobalGr||0,bruto:parseFloat(e.bruto||0).toFixed(3),kode_kategori:e.kodeKategori,kode_tukar:e.kadarTransaksi,disc_persen:e.disc_persen||0,keterangan:e.keterangan,jumlah_barang_set:o,total_berat_barang_set:n,kode_barcode_set:t,harga_jual:parseFloat(l)*parseFloat(s)},x={netto_disc:(parseFloat(e.bruto||0)*parseFloat(d)/100-parseFloat(e.disc_persen)*parseFloat(e.bruto||0)/100).toFixed(3),netto:(parseFloat(e.bruto||0)*parseFloat(d)/100||0).toFixed(3),ongkos_rp:parseFloat(void 0===e.rp?0:e.rp),disc:(parseFloat(e.disc_persen)/100*parseFloat(e.bruto||0)).toFixed(3),bruto:parseFloat(e.bruto||0),kode_kategori:e.kodeKategori,kode_tukar:d,keterangan:e.keterangan,jumlah_barang_set:o,total_berat_barang_set:n,kode_barcode_set:t,harga_jual:parseFloat(l)*parseFloat(s)},B={netto_disc:(parseFloat(e.bruto||0)*parseFloat(p)/100-parseFloat(e.disc_persen)*parseFloat(e.bruto||0)/100).toFixed(3),netto:(parseFloat(e.bruto||0)*parseFloat(p)/100||0).toFixed(3),ongkos_rp:parseFloat(void 0===e.rp?0:e.rp),disc:(parseFloat(e.disc_persen)/100*parseFloat(e.bruto||0)).toFixed(3),bruto:parseFloat(e.bruto||0),kode_kategori:e.kodeKategori,kode_tukar:p,keterangan:e.keterangan,jumlah_barang_set:o,total_berat_barang_set:n,kode_barcode_set:t,harga_jual:parseFloat(l)*parseFloat(s)};i.push(E),u.push(x),k.push(B),localStorage.setItem("nota_penjualan_level1",JSON.stringify(i)),localStorage.setItem("nota_penjualan_level2",JSON.stringify(u)),localStorage.setItem("nota_penjualan_level3",JSON.stringify(k))}var I={netto_disc:parseFloat(e.netto_disc||0).toFixed(3)||0,gross:parseFloat(e.gross||0).toFixed(3)||0,netto:parseFloat(e.netto||0).toFixed(3)||0,qty:s||1,k:parseFloat(e.k||0),ongkos_rp:parseFloat(void 0===e.rp?0:e.rp),kadar_cetak:(c[0].kadar_cetak||0).toString(),disc_persen:e.disc_persen||0,kadar_jual:parseFloat(e.kadar_jual||0),kadar_level2:a.data.level2||0,kadar_level3:a.data.level3||0,kadar_modal:c[0].kadar_modal||0,kode_jenis:c[0].kode_jenis||0,kode_barcode:"-",kode_barcode_set:t,p:parseFloat(e.p||0),disc:e.disc||0,pkg:parseFloat(e.pkg||0),bruto:parseFloat(e.bruto||0).toFixed(3),harga_jual:l},J=Object(f.e)({data:e,hasil:c,res:a,harga_jual:l}),T=Object(f.f)({data:e,res:a,hasil:c,harga_jual:l}),P=JSON.parse(localStorage.getItem("transaksiPenjualan"))||[],w=JSON.parse(localStorage.getItem("transaksiPenjualan_level2"))||[],D=JSON.parse(localStorage.getItem("transaksiPenjualan_level3"))||[];P.push(I),w.push(J),D.push(T);var C=P.map((function(a){return parseFloat(a.netto_disc)})).reduce((function(a,e){return a+e}),0);localStorage.setItem("GrandTotalNetto",C),localStorage.setItem("transaksiPenjualan",JSON.stringify(P)),localStorage.setItem("transaksiPenjualan_level2",JSON.stringify(w)),localStorage.setItem("transaksiPenjualan_level3",JSON.stringify(D)),y.a.fire({position:"top-end",icon:"success",text:"Data Berhasil Ditambahkan!",showConfirmButton:!1,timer:1500}),g.props.dispatch(Object(N.e)()),g.props.dispatch(Object(O.e)()),g.props.dispatch(Object(m.b)("FormTransaksiPenjualan")),g.props.dispatch(Object(K.o)("transaksiPenjualan")),Object(f.w)("discGlobal_penjualan"),g.props.dispatch(Object(G.g)()),g.setState({discGlobalGr:parseFloat(0)/100*parseFloat(localStorage.getItem("GrandTotalNetto")),discGlobalPr:0,GrandTotalNetto:(parseFloat(localStorage.getItem("GrandTotalNetto"))-0).toFixed(3)})})).catch((function(a){return Object(x.c)("Kode Kelompok Belum Disesuaikan, Mohon Sesuaikan Dahulu")}));case 12:case"end":return a.stop()}}),a,this)})));return function(e,t,o,r,n,l){return a.apply(this,arguments)}}()},{key:"render",value:function(){var a=this;return p.a.createElement("form",{onSubmit:this.props.handleSubmit},p.a.createElement("div",{className:"row"},p.a.createElement("div",{className:"col-md-12 col-lg-12 d-none"},p.a.createElement(k.a,{name:"noFaktur",label:this.props.noFaktur,type:"text",readOnly:!0,component:h.a,defaultValue:this.props.noFaktur,normalize:function(a){return a&&a.toUpperCase()}})),p.a.createElement("div",{className:"col-md-4 col-lg-4"},""!==String(this.props.KodeBarangList)?p.a.createElement(k.a,{name:"kodeBarang",label:"Kode Model",component:h.b,className:"form-control",onChange:function(e){return a.pilihBarang(e)},onBlur:this.setKadar(),options:this.props.KodeBarangList.filter((function(a){return"PERHIASAN"===a.kode_kelompok||"AKSESORIS"===a.kode_kelompok})).map((function(a){return{value:a.kode_jenis,name:a.nama_jenis}}))}):p.a.createElement(v.a,{width:"100%",height:50})),p.a.createElement("div",{className:"col-md-4 col-lg-4"},p.a.createElement(k.a,{name:"kode_barocde",label:"Kode Barcode",type:"text",component:h.a,placeholder:"Biarkan Kosong jika Tidak Digunakan",normalize:function(a){return a&&a.toUpperCase()},onChange:this.handleBarcode()})),p.a.createElement("div",{className:(this.state.aksesoris,"col-md-3 col-lg-3 d-none")},p.a.createElement(k.a,{name:"kadar",label:"Kode Tukar",type:"number",component:h.a,readOnly:!0})),p.a.createElement("div",{className:"col-md-3 col-lg-3 d-none"},p.a.createElement(k.a,{name:"kodeKategori",label:"Kode Tukar",type:"number",component:h.a})),p.a.createElement("div",{className:this.state.non_aksesoris},p.a.createElement("div",{className:"col-md-12 col-lg-12"},p.a.createElement(k.a,{name:"keterangan",label:"Keterangan",type:"text",component:h.a,normalize:function(a){return null===a||void 0===a?void 0:a.toUpperCase()}})),p.a.createElement("div",{className:"col-md-3 col-lg-3 d-none"},p.a.createElement(k.a,{name:"namaKategori",label:"Kode Tukar",type:"number",component:h.a})),p.a.createElement("div",{className:"col-md-3 col-lg-3"},p.a.createElement(k.a,{name:"p",label:"Plastik",type:"number",component:h.a})),p.a.createElement("div",{className:"col-md-3 col-lg-3"},p.a.createElement(k.a,{name:"k",label:"Kertas",type:"number",component:h.a})),p.a.createElement("div",{className:"col-md-3 col-lg-3"},p.a.createElement(k.a,{name:"pkg",label:"Pkg (Gr)",type:"number",component:h.a,onBlur:function(){return a.onclick1()}})),p.a.createElement("div",{className:"col-md-3 col-lg-3"},p.a.createElement(k.a,{name:"bruto",label:"Berat (Gr)",type:"number",component:h.a,onChange:this.onclick1()})),p.a.createElement("div",{className:"col-md-3 col-lg-3"},p.a.createElement(k.a,{name:"kadarTransaksi",label:"Kode Tukar",type:"number",component:h.a,readOnly:!0,onBlur:function(){return a.onclick1()}})),p.a.createElement("div",{className:"col-md-3 col-lg-3"},p.a.createElement(k.a,{name:"netto",label:"Netto (Gr)",type:"number",component:h.a,readOnly:!0})),p.a.createElement("div",{className:"col-md-3 col-lg-3"},p.a.createElement(k.a,{name:"gross",label:"Gross (Gr)",type:"number",component:h.a,readOnly:!0})),p.a.createElement("div",{className:"col-md-3 col-lg-3"},p.a.createElement(k.a,{name:"discGlobalPr",label:"Diskon (%)",type:"number",component:h.a,onBlur:function(){return a.onclick1()}})),p.a.createElement("div",{className:"col-md-3 col-lg-3"},p.a.createElement(k.a,{name:"discGlobalGr",label:"Diskon (Gr)",type:"number",component:h.a,readOnly:!0})),p.a.createElement("div",{className:"col-md-3 col-lg-3"},p.a.createElement(k.a,{name:"nettoDiscGlobalExt",label:"Netto - Diskon (Gr)",type:"number",component:h.a,readOnly:!0})),p.a.createElement("div",{className:"col-md-3 col-lg-3"},p.a.createElement("label",{htmlFor:""},"Ongkos (Rp)"),p.a.createElement(k.a,Object.assign({name:"rp",component:"input",type:"tel",className:"form-control"},B)))),p.a.createElement("div",{className:this.state.aksesoris},p.a.createElement("div",{className:"col-lg-3"},p.a.createElement(k.a,{name:"qty",label:"Qty",type:"number",component:h.a})),p.a.createElement("div",{className:"col-lg-3"},p.a.createElement(k.a,Object.assign({name:"harga_jual",label:"Harga Jual",type:"telp",component:h.a},B)))),p.a.createElement("div",{className:"col-lg-12 col-md-12"},p.a.createElement("div",{className:"text-right"},p.a.createElement("button",{type:"submit",disabled:this.props.onSend,className:"btn btn-primary"},this.props.onSend?p.a.createElement("span",{className:"spinner-border spinner-border-sm mr-3","aria-hidden":"true"}):null,"Simpan",p.a.createElement("i",{className:"fa fa-paper-plane ml-3"}))))))}}]),t}(d.Component);I=Object(g.a)({form:"FormTransaksiPenjualan",enableReinitialize:!0})(I);var J=Object(_.a)("FormTransaksiPenjualan");e.default=Object(u.b)((function(a){var e=J(a,"bruto","kadarTransaksi","pkg","discGlobalPr"),t=e.bruto,o=e.kadarTransaksi,r=e.pkg,n=e.discGlobalPr;return{netto:(parseFloat(t||0)*(parseFloat(o||0)/100)).toFixed(3),gross:parseFloat(t||0)+parseFloat(r||0),discGlobalGr:(parseFloat(t||0)*(parseFloat(n||0)/100)).toFixed(3),KodeBarangList:a.provinsi.kodeBarang,onSend:a.provinsi.onSend,initialValues:{discGlobalPr:0,p:0,k:0,pkg:0,bruto:0},bruto:t}}))(I)}}]);
//# sourceMappingURL=153.51635cdc.chunk.js.map